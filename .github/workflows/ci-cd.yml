name: CI/CD Pipeline
on:
 push:
   branches:
   - main

jobs:
  build-and-test:
   runs-on: ubuntu-latest
   
   steps:
    - name: Setup node js
      run: echo "#==================seting up node js ====================="
    - name: Installing dependensies
      run: echo "#================== Instaling ====================="
    - name: building
      run: echo "#================== BUILDING ====================="
    
  
  deploy:
    needs: build-and-test
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup SSH
        uses: webfactory/ssh-agent@v0.9.0
        with:
          ssh-private-key: ${{secrets.SSH_PRIVATE_KEY}}      
      - name: Deploy to VPS
        run: |
          ssh -o StrictHostKeyChecking=no ${{ secrets.USERNAME }}@${{ secrets.HOST }} << 'EOF'
          cd /home
          mkdir -p actions
          cd actions
          echo "Hello world from GitHub Actions!" > helloworld.txt
          EOF

